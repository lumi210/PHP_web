import{j as d,A as C,B,_ as T,C as w}from"./index-BGkrm5xk.js";import{h as V,a as j,j as g,k as l,m as i,T as p,x as h,a5 as F,Y as k,X as y,U as I,_ as x,a7 as L,o,l as N,p as R,a8 as $}from"./vue-Cm_-Ome7.js";const z=["id"],D={key:0,class:"loading"},E={key:1,class:"captcha-img-box"},S=["src","alt"],U=["onClick"],X={key:2,class:"captcha-prompt"},Y={key:3,class:"captcha-prompt"},A={class:"captcha-refresh-box"},M=["title"],P=V({__name:"index",props:{uuid:{default:""},callback:{type:Function,default:()=>{}},class:{default:""},unset:{type:Boolean,default:!1},error:{default:d.global.t("validate.The correct area is not clicked, please try again!")},success:{default:d.global.t("validate.Verification is successful!")}},setup(u){L(a=>({d12e9cce:v.value,"384b94fa":b.value,"91648b58":t.captcha.width,"189a9659":t.captcha.height}));const e=u,t=j({loading:!0,xy:[],tip:"",captcha:{id:"",text:"",base64:"",width:350,height:200}}),n=()=>{t.loading=!0,C(e.uuid).then(a=>{t.xy=[],t.tip="",t.loading=!1,t.captcha=a.data})},_=a=>{if(t.xy.length<t.captcha.text.length&&(t.xy.push(a.offsetX+","+a.offsetY),t.xy.length==t.captcha.text.length)){const s=[t.xy.join("-"),a.target.width,a.target.height].join(";");B(e.uuid,s,e.unset).then(()=>{t.tip=e.success,setTimeout(()=>{var c;(c=e.callback)==null||c.call(e,s),f()},1500)}).catch(()=>{t.tip=e.error,setTimeout(()=>{n()},1500)})}},m=a=>{t.xy.splice(a,1)},f=()=>{var a;(a=document.getElementById(e.uuid))==null||a.remove()},b=g(()=>(t.captcha.height+200)/2+"px"),v=g(()=>(t.captcha.width+24)/2+"px");return n(),(a,s)=>(o(),l("div",{id:a.uuid},[i("div",{class:x(["ba-click-captcha",e.class])},[t.loading?(o(),l("div",D,p(h(d).global.t("utils.Loading")),1)):(o(),l("div",E,[i("img",{class:"captcha-img",onClick:s[0]||(s[0]=F(c=>_(c),["prevent"])),src:t.captcha.base64,alt:h(d).global.t("validate.Captcha loading failed, please click refresh button")},null,8,S),(o(!0),l(k,null,y(t.xy,(c,r)=>(o(),l("span",{key:r,class:"step",onClick:G=>m(r),style:N(`left:${parseFloat(c.split(",")[0])-13}px;top:${parseFloat(c.split(",")[1])-13}px`)},p(r+1),13,U))),128))])),t.tip?(o(),l("div",X,p(t.tip),1)):(o(),l("div",Y,[I(p(h(d).global.t("validate.Please click"))+" ",1),(o(!0),l(k,null,y(t.captcha.text,(c,r)=>(o(),l("span",{key:r,class:x(t.xy.length>r?"clicaptcha-clicked":"")},p(c),3))),128))])),i("div",A,[s[1]||(s[1]=i("div",{class:"captcha-refresh-line captcha-refresh-line-l"},null,-1)),i("i",{class:"fa fa-refresh captcha-refresh-btn",title:h(d).global.t("Refresh"),onClick:n},null,8,M),s[2]||(s[2]=i("div",{class:"captcha-refresh-line captcha-refresh-line-r"},null,-1))])],2),i("div",{class:"ba-layout-shade",onClick:f})],8,z))}}),q=T(P,[["__scopeId","data-v-c6505233"]]),K=(u,e,t={})=>{let n=R(q,{uuid:u,callback:e,...t,key:w()});$(n,document.body),n=null};export{K as c};
