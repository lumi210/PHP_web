import{c as X,w as ee,a5 as u,am as te,a7 as oe,_ as ae}from"./index-BGkrm5xk.js";import{_ as ne}from"./popupForm.vue_vue_type_script_setup_true_lang-CvKKv6Eg.js";import{b as le,R as $,T as se,a as re}from"./index-D7pEq_sT.js";import{u as B}from"./lang-Ch7gu2FI.js";import{_ as ce}from"./index.vue_vue_type_style_index_0_lang-KySb_zIR.js";import{h as de,s as q,a as E,j as ie,at as I,B as me,q as m,W as pe,o as d,k as ue,x as a,N as i,V as _,p as s,O as l,Z as x,m as f,T as b,U as R}from"./vue-Cm_-Ome7.js";import"./index-Gg8Utg5G.js";import"./validate-CLs7Ey-q.js";import"./Extfield-CKk9p3fq.js";import"./index-6wQyfZWi.js";const fe="/admin/cms.Content/";function be(N,e,C){return X({url:fe+N,method:"post",data:{scode:e,ids:C}},{showSuccessMessage:!0})}const ge={class:"default-main ba-table-box"},he={class:"table-header-operate-text"},_e={class:"table-header-operate-text"},ye={class:"mlr-12"},we={class:"table-header-operate-text"},ve={class:"table-header-operate-text"},Ce={class:"table-header-operate-text"},ke={class:"dialog-footer"},Se=de({name:"cms/content",__name:"index",setup(N){const{t:e}=ee.useI18n(),C=q(),T=q(),U=[{render:"tipButton",name:"custom-edit",title:"编辑",text:"",type:"primary",icon:"fa fa-pencil",class:"ba-table-render-buttons-item",disabledTip:!1,display:(n,o)=>u({name:"/admin/cms/content",subNodeName:"/admin/cms/content/edit"}),click:(n,o)=>{t.onTableAction("edit",{row:n})}},{render:"confirmButton",name:"custom-delete",title:"删除",text:"",type:"danger",icon:"fa fa-trash",class:"table-row-delete",disabledTip:!1,popconfirm:{confirmButtonText:e("Delete"),cancelButtonText:e("Cancel"),confirmButtonType:"danger",title:e("Are you sure to delete the selected record?")},display:(n,o)=>u({name:"/admin/cms/content",subNodeName:"/admin/cms/content/edit"}),click:(n,o)=>{t.onTableAction("delete",{row:n})}}],D=te().split("/"),g=D[D.length-1],k=E({select:!0,order:"sorting,asc",istop:0,acode:B().getDataLang(),search:[{field:"mcode",operator:"=",val:g}]}),h=new Date,L=h.getFullYear(),M=String(h.getMonth()+1).padStart(2,"0"),H=String(h.getDate()).padStart(2,"0"),P=String(h.getHours()).padStart(2,"0"),F=String(h.getMinutes()).padStart(2,"0"),O=String(h.getSeconds()).padStart(2,"0"),j=`${L}-${M}-${H} ${P}:${F}:${O}`,c=E({id:"",show:!1,type:"copy"}),t=new le(new oe("/admin/cms.Content/"),{pk:"id",column:[{type:"selection",align:"center",operator:!1},{label:e("cms.content.id"),prop:"id",align:"center",width:80,operator:!1,sortable:"custom"},{label:e("cms.content.scode"),prop:"scode",show:!1,align:"left",width:180,comSearchRender:"slot",comSearchSlotName:"scode",enableColumnDisplayControl:!1},{label:e("cms.content.scode"),prop:"contentsort.name",width:180,align:"left",operator:!1,sortable:!1},{label:e("cms.content.title"),prop:"title",align:"left",operatorPlaceholder:e("Fuzzy query"),operator:"LIKE",sortable:!1},{label:e("cms.content.date"),prop:"date",align:"left",render:"datetime",operator:"RANGE",comSearchRender:"date",sortable:"custom",width:200,show:!1,enableColumnDisplayControl:!1},{label:e("cms.content.date"),prop:"date",align:"left",sortable:"custom",width:200,operator:!1},{label:e("cms.content.sorting"),prop:"sorting",align:"center",render:"slot",slotName:"sorting",operator:!1,sortable:!1},{label:e("cms.content.status"),width:100,prop:"status",align:"center",render:"switch",operator:"eq",sortable:!1,replaceValue:{}},{label:e("cms.content.istop"),width:100,prop:"istop",align:"center",render:"switch",operator:"eq",sortable:!1},{label:e("cms.content.isrecommend"),width:100,prop:"isrecommend",align:"center",render:"switch",operator:"eq",sortable:!1},{label:e("cms.content.visits"),width:100,prop:"visits",align:"center",operator:!1,sortable:!1},{label:e("Operate"),align:"center",width:150,render:"buttons",buttons:U,operator:!1}],filter:{mcode:g},dblClickNotEditColumn:[void 0],showComSearch:!0},{defaultItems:{sorting:255,status:"1",visits:0,likes:0,oppose:0,gtype:"4",mcode:g,date:j}}),y=ie(()=>t.table.selection.length>0);t.requestEdit=n=>{if(t.runBefore("requestEdit",{id:n})!==!1)return t.form.loading=!0,t.form.items={},t.api.edit({[t.table.pk]:n,mcode:g}).then(o=>{t.form.items=o.data.row,t.form.items.mcode=g,t.runAfter("requestEdit",{res:o})}).catch(o=>{t.toggleForm(),t.runAfter("requestEdit",{err:o})}).finally(()=>{t.form.loading=!1})},I("baTable",t),I("mcode",g),me(()=>{var n;t.table.ref=C.value,t.mount(),(n=t.getIndex())==null||n.then(()=>{t.initSort(),t.dragSort()})});const z=(n,o)=>{o.loading=!0,t.api.postData("edit",{[t.table.pk]:o[t.table.pk],sorting:n}).then(()=>{t.onTableAction("field-change",{value:n,...o}),t.table.data=[],t.getIndex()}).finally(()=>{o.loading=!1})},G=()=>{k.search[1].val=B().getDataLang(),T.value.getData()},V=n=>{c.show=!0,c.type=n},K=()=>{const n=t.getSelectionIds();n.length!=0&&be(c.type,c.id,n).then(o=>{c.show=!1,c.id="",o.code==1&&t.getIndex()})};return(n,o)=>{const Q=m("el-alert"),w=m("Icon"),p=m("el-button"),v=m("el-tooltip"),W=m("el-popconfirm"),Y=m("el-input"),Z=m("el-table-column"),J=m("el-dialog"),S=pe("blur");return d(),ue("div",ge,[a(t).table.remark?(d(),i(Q,{key:0,class:"ba-table-alert",title:a(t).table.remark,type:"info","show-icon":""},null,8,["title"])):_("",!0),s(se,{buttons:["refresh","comSearch","quickSearch","columnDisplay"],"quick-search-placeholder":a(e)("Quick search placeholder",{fields:a(e)("cms.content.title")})},{refreshAppend:l(()=>[s(ce,{onChangeDataLang:G}),a(u)({name:"/admin/cms/content",subNodeName:"/admin/cms/content/add"})?(d(),i(v,{key:0,content:a(e)("Add"),placement:"top"},{default:l(()=>[x((d(),i(p,{onClick:o[0]||(o[0]=r=>a(t).onTableHeaderAction("add",{})),class:"table-header-operate",type:"primary"},{default:l(()=>[s(w,{name:"fa fa-plus"}),f("span",he,b(a(e)("Add")),1)]),_:1})),[[S]])]),_:1},8,["content"])):_("",!0),a(u)({name:"/admin/cms/content",subNodeName:"/admin/cms/content/edit"})?(d(),i(v,{key:1,content:a(e)("Edit selected row"),placement:"top"},{default:l(()=>[x((d(),i(p,{onClick:o[1]||(o[1]=r=>a(t).onTableHeaderAction("edit",{})),disabled:!y.value,class:"table-header-operate",type:"primary"},{default:l(()=>[s(w,{name:"fa fa-pencil"}),f("span",_e,b(a(e)("Edit")),1)]),_:1},8,["disabled"])),[[S]])]),_:1},8,["content"])):_("",!0),a(u)({name:"/admin/cms/content",subNodeName:"/admin/cms/content/del"})?(d(),i(W,{key:2,onConfirm:o[2]||(o[2]=r=>a(t).onTableHeaderAction("delete",{})),"confirm-button-text":a(e)("Delete"),"cancel-button-text":a(e)("Cancel"),confirmButtonType:"danger",title:a(e)("Are you sure to delete the selected record?"),disabled:!y.value},{reference:l(()=>[f("div",ye,[s(v,{content:a(e)("Delete selected row"),placement:"top"},{default:l(()=>[x((d(),i(p,{disabled:!y.value,class:"table-header-operate",type:"danger"},{default:l(()=>[s(w,{name:"fa fa-trash"}),f("span",we,b(a(e)("Delete")),1)]),_:1},8,["disabled"])),[[S]])]),_:1},8,["content"])])]),_:1},8,["confirm-button-text","cancel-button-text","title","disabled"])):_("",!0)]),scode:l(()=>[s($,{modelValue:a(t).comSearch.form.scode,"onUpdate:modelValue":o[3]||(o[3]=r=>a(t).comSearch.form.scode=r),pk:"content_sort.scode",field:"name",remoteUrl:"/admin/cms.ContentSort/index",params:k,ref_key:"scodeRef",ref:T,class:"el-select"},null,8,["modelValue","params"])]),default:l(()=>[a(u)({name:"/admin/cms/content",subNodeName:"/admin/cms/content/copy"})?(d(),i(v,{key:0,content:a(e)("cms.content.Copy selected row"),placement:"top"},{default:l(()=>[s(p,{class:"table-header-operate",type:"primary",onClick:o[4]||(o[4]=r=>V("copy")),disabled:!y.value,style:{"margin-left":"12px"}},{default:l(()=>[s(w,{color:"#ffffff",name:"el-icon-CopyDocument"}),f("span",ve,b(a(e)("cms.content.copy")),1)]),_:1},8,["disabled"])]),_:1},8,["content"])):_("",!0),a(u)({name:"/admin/cms/content",subNodeName:"/admin/cms/content/move"})?(d(),i(v,{key:1,content:a(e)("cms.content.Move selected row"),placement:"top"},{default:l(()=>[s(p,{class:"table-header-operate",type:"primary",onClick:o[5]||(o[5]=r=>V("move")),disabled:!y.value},{default:l(()=>[s(w,{color:"#ffffff",name:"el-icon-Magnet"}),f("span",Ce,b(a(e)("cms.content.move")),1)]),_:1},8,["disabled"])]),_:1},8,["content"])):_("",!0)]),_:1},8,["quick-search-placeholder"]),s(re,{ref_key:"tableRef",ref:C},{sorting:l(()=>[s(Z,{label:a(e)("cms.content.sorting"),width:"100",align:"left"},{default:l(r=>[s(Y,{modelValue:r.row.sorting,"onUpdate:modelValue":A=>r.row.sorting=A,onChange:A=>z(r.row.sorting,r.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1},8,["label"])]),_:1},512),s(ne),s(J,{modelValue:c.show,"onUpdate:modelValue":o[8]||(o[8]=r=>c.show=r),title:a(e)("cms.content.Please Select a Category"),width:"400"},{footer:l(()=>[f("div",ke,[s(p,{onClick:o[7]||(o[7]=r=>c.show=!1)},{default:l(()=>[R(b(a(e)("Cancel")),1)]),_:1}),s(p,{type:"primary",onClick:K},{default:l(()=>[R(b(a(e)("Save")),1)]),_:1})])]),default:l(()=>[s($,{modelValue:c.id,"onUpdate:modelValue":o[6]||(o[6]=r=>c.id=r),pk:"content_sort.scode",field:"name",remoteUrl:"/admin/cms.ContentSort/index",params:k,class:"el-select"},null,8,["modelValue","params"])]),_:1},8,["modelValue","title"])])}}}),Re=ae(Se,[["__scopeId","data-v-e2409915"]]);export{Re as default};
